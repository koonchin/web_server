<!DOCTYPE html>
<html lang="en">

<head>
    <!-- Required meta tags -->
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />

    <head>
        <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-1BmE4kWBq78iYhFldvKuhfTAU6auU8tT94WrHftjDbrCEXSU1oBoqyl2QvZ6jIW3" crossorigin="anonymous" />
        <script src="https://cdn.jsdelivr.net/jsbarcode/3.6.0/JsBarcode.all.min.js"></script>
        <script type="text/javascript" src="/media/qr/qrcode.min.js"></script>
        <link href="https://fonts.googleapis.com/css2?family=IBM+Plex+Sans+Thai:wght@400;600&family=Montserrat&display=swap" rel="stylesheet">

        <style>
            body {
                font-family: 'Montserrat', "IBM Plex Sans Thai";
            }
            
            .center-forms {
                position: relative;
                width: 780px;
                height: 50px;
                left: 50%;
                top: 100px;
                margin-left: -390px;
                font-size: 150%;
                float: right;
            }
        </style>
    </head>

    <body>
        <div id="printed">
            <div class="row">
                <script src="https://cdn.rawgit.com/davidshimjs/qrcodejs/gh-pages/qrcode.min.js"></script>
                <script>
                    // Extract data from the URL parameters
                    const urlParams = new URLSearchParams(window.location.search);

                    // Create an array to store the formatted results
                    const qrData = [];

                    // Iterate through all parameters
                    for (const [key, value] of urlParams.entries()) {
                        // Check if the key ends with "_amount"
                        if (key.endsWith('_amount')) {
                            // Extract the base key without "_amount"
                            const baseKey = key.replace('_amount', '');

                            // Add formatted results to the array
                            for (let i = 0; i < parseInt(value, 10); i++) {
                                qrData.push(baseKey);
                            }

                        }
                    }
                    // Create a row div
                    var rowDiv = document.createElement('div');
                    rowDiv.className = 'row';

                    for (var i = 0; i < qrData.length; i++) {
                        var currentData = qrData[i];
                        var divId = i + currentData; // Unique ID for each QR code

                        // Create div.col-6 element
                        var colDiv = document.createElement('div');
                        colDiv.className = 'col-6';

                        // Create div for QR code
                        var qrDiv = document.createElement('div');
                        qrDiv.style.marginTop = '1mm';
                        qrDiv.style.marginLeft = i % 2 === 0 ? '3mm' : '14mm';
                        qrDiv.id = divId;

                        // Append QR code div to col div
                        colDiv.appendChild(qrDiv);

                        // Create QR code
                        new QRCode(qrDiv, {
                            text: currentData,
                            width: 50,
                            height: 50,
                            correctLevel: QRCode.CorrectLevel.H,
                            useSVG: true
                        });

                        // Create div for data
                        var dataDiv = document.createElement('div');
                        dataDiv.style.marginLeft = i % 2 === 0 ? '1mm' : '11mm';
                        dataDiv.innerHTML = currentData;

                        // Append data div to col div
                        colDiv.appendChild(dataDiv);

                        // Append col div to the row div
                        rowDiv.appendChild(colDiv);
                    }

                    // Append the row div to the printed div
                    document.getElementById('printed').appendChild(rowDiv);
                </script>
            </div>
        </div>


        <script>
            window.onload = function() {
                printDiv("printed");
            };

            function printDiv(divName) {
                var printContents = document.getElementById(divName).innerHTML;
                var originalContents = document.body.innerHTML;

                document.body.innerHTML = printContents;

                window.print();
                document.body.innerHTML = originalContents;
                setTimeout("closePrintView()", 3000);
            }

            function closePrintView() {
                document.location.href = 'share_barcode offline.html';
            }
        </script>

        <script src="https://cdn.jsdelivr.net/npm/@popperjs/core@2.10.2/dist/umd/popper.min.js" integrity="sha384-7+zCNj/IqJ95wo16oMtfsKbZ9ccEh31eOz1HGyDuCQ6wgnyJNSYdrPa03rtR1zdB" crossorigin="anonymous"></script>
        <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/js/bootstrap.min.js" integrity="sha384-QJHtvGhmr9XOIpI6YVutG+2QOK9T+ZnN4kzFN1RtK3zEFEIsxhlmWl5/YESvpZ13" crossorigin="anonymous"></script>
        <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/js/bootstrap.bundle.min.js" integrity="sha384-ka7Sk0Gln4gmtz2MlQnikT1wXgYsOg+OMhuP+IlRH9sENBO0LRn5q+8nbTov4+1p" crossorigin="anonymous"></script>
    </body>
</head>

</html>